{"version":3,"sources":["test.worker.ts","common/geometry.ts","InputImageUrl.tsx","RendererFromUrl.tsx","RendererFromDrawing.tsx","RendererFromData.tsx","GAInformation.tsx","InputRange.tsx","GAConfiguration.tsx","GAConfigurationInfo.tsx","MyApp.tsx","index.tsx"],"names":["Worker_fn","Worker","getRGBAFromColor","c","length","drawPolygon","ctx","polygon","vertices","fillStyle","color","beginPath","vertex","moveTo","x","y","i","lineTo","closePath","fill","getLimitDimensions","width","height","limit","ratioImage","Math","round","ratio","InputImageUrl","start","stop","links","isStopped","className","useState","url","setUrl","onSubmit","e","preventDefault","direction","spacing","align","type","name","value","onChange","target","disabled","id","onClick","linkElements","forEach","link","elem","variant","currentTarget","push","generateLinks","RendererFromUrl","label","onImageDrawn","onLoadingError","classNameOnError","canvasRef","useRef","isErrorOnLoad","setError","imageUrl","setImageUrl","useEffect","canvas","current","getContext","img","Image","crossOrigin","onload","console","error","drawImage","src","onerror","status","mr","ref","fontSize","RendererFromDrawing","ratioW","ratioH","drawingSteps","clearRect","fillRect","scale","shape","draw","RendererFromData","data","putImageData","GAInformation","generation","fitness","ssim","pixelDiff","subPixel","idBest","elapsedTimeForGeneration","notImprovingSince","nbPolygons","isNumeric","toFixed","InputRange","defaultVal","min","max","step","tooltip","setValue","placement","closeOnClick","bg","offset","newValue","valueAsNumber","GAConfiguration","population","parentSelectionStrategy","selectCutoff","tournamentSize","keepPreviousRatio","newIndividualRatio","crossoverParentRatio","mutationRate","crossoverStrategy","vertexMovement","colorModificationRate","copyColorNeighborRate","addPolygonRate","removePolygonRate","enableSsim","enablePixelDiff","enableSubDiff","ratioSsim","ratioPixelDiff","ratioSubDiff","ratioPolygons","enableTransparency","nbVertex","enableVariablePolygons","resolution","onValuesChange","values","setValues","as","size","v","htmlFor","checked","isChecked","GAConfigurationInfo","elements","generateTournamentInforation","enabledEngines","join","generateFitnessEngineInformation","MyApp","configuration","setConfiguration","isRunning","best","genes","diff","undefined","probability","phenotype","elapsedTime","simulation","setSimulation","response","setResponse","image","renderedWidth","renderedHeight","ratioOffscreenWidth","ratioOffscreenHeight","offscreenWidth","offscreenHeight","limitOffscreen","imageFromUrl","setImage","myWorkerInstance","setWorker","setStop","handleResponse","useCallback","handleStart","newWorker","MyWorker","log","addEventListener","message","renderingHeight","renderingWidth","postMessage","handleStop","terminate","handleUrlImageDrawn","simDimensions","OffscreenCanvas","getImageData","handleLoadingImageError","handleValuesChange","config","rootElement","document","getElementById","render"],"mappings":"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","file":"static/js/main.b6dc0c4e.chunk.js","sourcesContent":["export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/test.worker.bfc21add.js\");\n}\n","import { Context } from \"vm\";\r\n\r\nexport interface Rect {\r\n    x: number;\r\n    y: number;\r\n    w: number;\r\n    h: number;\r\n    color: number[];\r\n}\r\n\r\nexport interface Vertex {\r\n    x: number;\r\n    y: number;\r\n}\r\n\r\nexport interface Polygon {\r\n    vertices: Vertex[];\r\n    color: number[];\r\n}\r\n\r\nexport interface Image {\r\n    image: ImageData|null;\r\n    renderedWidth: number;\r\n    renderedHeight: number;\r\n    offscreenWidth: number;\r\n    offscreenHeight: number;\r\n    ratioOffscreenWidth: number; // ratio to limit\r\n    ratioOffscreenHeight: number; // ratio to limit\r\n    limitOffscreen: number;\r\n}\r\n\r\nexport function getRGBAFromColor(c: number[]): string {\r\n    let color = \"rgb(0, 0, 0\";\r\n    if (c.length === 3) {\r\n        color = `rgb(${c[0]},${c[1]},${c[2]})`;\r\n    }\r\n    else {\r\n        color = `rgba(${c[0]},${c[1]},${c[2]},${c[3]})`\r\n    }\r\n    return color;\r\n}\r\n\r\nexport function drawRectangle(ctx: Context, rect: Rect) {\r\n    if (!ctx ) {\r\n        return;\r\n    }\r\n\r\n    ctx.fillStyle =  getRGBAFromColor(rect.color);;\r\n    ctx.fillRect(rect.x, rect.y, rect.w, rect.h);\r\n}\r\n\r\nexport function drawPolygon(ctx: Context, polygon: Polygon) {\r\n    if (!ctx || polygon.vertices.length === 0) {\r\n        return;\r\n    }\r\n\r\n    ctx.fillStyle = getRGBAFromColor(polygon.color);\r\n    ctx.beginPath();\r\n\r\n    let vertex = polygon.vertices[0];\r\n    ctx.moveTo(vertex.x, vertex.y);\r\n    for(let i = 1; i < polygon.vertices.length; i++) {\r\n        vertex = polygon.vertices[i];\r\n        ctx.lineTo(vertex.x, vertex.y);\r\n    }\r\n\r\n    ctx.closePath();\r\n    ctx.fill();\r\n}\r\n\r\nexport function moveVertex(v: Vertex, range: number, width: number, height: number): Vertex {\r\n    const direction = Math.random() * 2 * Math.PI;\r\n    const distance = Math.random() * range;\r\n\r\n    let x = v.x + Math.floor(Math.cos(direction) * distance);\r\n    x = Math.max(0, Math.min(x, width));\r\n\r\n    let y = v.y + Math.floor(Math.sin(direction) * distance);\r\n    y = Math.max(0, Math.min(y, height));\r\n\r\n    const movedVertex: Vertex = {\r\n        x: x,\r\n        y: y\r\n    };\r\n\r\n    return movedVertex; \r\n  };\r\n\r\n  export function copyPolygon(p: Polygon): Polygon {\r\n      const vertices: Vertex[] = [];\r\n      p.vertices.forEach((vertex: Vertex) => {\r\n          let v = {...vertex};\r\n          vertices.push(v);\r\n      });\r\n\r\n      const polygon = {\r\n          vertices: vertices,\r\n          color: [...p.color]\r\n      };\r\n\r\n      return polygon;\r\n  }\r\n\r\n export function getLimitDimensions(width: number, height: number, limit?: number): {width: number, height: number, ratio: number} {\r\n    const ratioImage = height / width;\r\n    if (limit && (width >= limit || height >= limit)) {        \r\n        if (ratioImage > 1) {\r\n            return { width: Math.round(limit / ratioImage), height: limit, ratio: ratioImage };\r\n        }\r\n        else {\r\n            return { width: limit, height: Math.round(limit * ratioImage), ratio: ratioImage};\r\n        }\r\n        \r\n    }\r\n    return { width: width, height: height, ratio: ratioImage};\r\n}","import './InputImageUrl.css';\r\nimport React, {useState} from 'react';\r\nimport { Input, Button, Stack } from \"@chakra-ui/react\"\r\n\r\nexport interface InputImageProps {\r\n    start: (url: string) => void;\r\n    stop: () => void;\r\n    links: {name: string, link: string}[] ;\r\n    isStopped: boolean;\r\n    className: string;\r\n};\r\n\r\nexport function InputImageUrl({start, stop, links, isStopped, className}: InputImageProps) {\r\n    const [url, setUrl] = useState<string>('https://my-image-url');\r\n  \r\n    const onSubmit = (e: React.FormEvent<HTMLFormElement>) => {\r\n      e.preventDefault();\r\n      start && start(url);\r\n    }\r\n\r\n    const onStop = () => {\r\n        stop && stop();\r\n    }\r\n\r\n    const generateLinks = (): JSX.Element[] =>  {\r\n        const linkElements: JSX.Element[] = [];\r\n        links.forEach((link => {\r\n            const elem: JSX.Element = <Button key={link.name} variant=\"link\" value={link.link} onClick={e => {setUrl(e.currentTarget.value);}} > {link.name} </Button>; \r\n            linkElements.push(elem);\r\n        }))\r\n        return linkElements;\r\n    }\r\n\r\n    return (\r\n        <div className={className}>\r\n            <div>\r\n                <form onSubmit={onSubmit}>\r\n                    <Stack direction=\"row\" spacing={4} align=\"center\">\r\n                        <Input type=\"text\" name=\"image-url\" value={url} onChange={e => setUrl(e.target.value)} />\r\n                        <Button disabled={!isStopped} type=\"submit\" id=\"start-button\">Start</Button>        \r\n                        <Button disabled={isStopped} type=\"button\" id=\"stop-button\" onClick={onStop}>Stop</Button>      \r\n                    </Stack>  \r\n                </form>                \r\n            </div>\r\n            <div>\r\n                <Stack direction=\"row\" spacing={4} align=\"center\">\r\n                    {generateLinks()}\r\n                </Stack>\r\n            </div>            \r\n        </div>\r\n    )\r\n} ","import './RendererFromUrl.css';\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport { getLimitDimensions } from './common/geometry';\r\nimport { Alert, AlertDescription, AlertIcon, AlertTitle } from '@chakra-ui/alert';\r\nimport { Text, VStack } from '@chakra-ui/react';\r\n\r\nexport interface RendererProps {\r\n    name: string;  \r\n    url: string;\r\n    label: string;\r\n    limit?: number;\r\n    onImageDrawn: (img: CanvasImageSource, renderedWidth: number, renderedHeight: number) => void;\r\n    onLoadingError: () => void;\r\n    className: string;\r\n    classNameOnError: string;\r\n};\r\n\r\nexport function RendererFromUrl({ name, url, label, limit, onImageDrawn, onLoadingError, className, classNameOnError }: RendererProps) {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const [isErrorOnLoad, setError] = useState<boolean>(false);\r\n    const [imageUrl, setImageUrl] = useState<string>(\"\"); \r\n\r\n    useEffect(() => {       \r\n        if (url !== imageUrl)\r\n        {\r\n            setImageUrl(url);\r\n            setError(false);\r\n            const canvas = canvasRef.current as HTMLCanvasElement;\r\n            if (canvas) {\r\n                const ctx = canvas.getContext('2d');\r\n            \r\n                const img = new Image();\r\n                img.crossOrigin = \"Anonymous\";  // This enables CORS\r\n                img.onload = () => {\r\n                    const { width, height } = getLimitDimensions(img.width, img.height, limit);            \r\n                    if (width === 0 || height === 0) {\r\n                        console.error(\"Fail to load the image\");\r\n                    }\r\n        \r\n                    canvas.width = width;\r\n                    canvas.height = height;\r\n        \r\n                    if (ctx) {\r\n                        ctx.drawImage(img, 0, 0, width, height);\r\n                        onImageDrawn?.(img, width, height);\r\n                    }\r\n                    else {\r\n                        console.error(\"ctx is null the image can not be loaded\");\r\n                    }                        \r\n                };\r\n                img.src = url;\r\n                img.onerror = () => {\r\n                    setError(true);\r\n                    onLoadingError();\r\n                }    \r\n            }\r\n        }         \r\n    }, [url, limit, onImageDrawn, onLoadingError, imageUrl]);\r\n\r\n    return (\r\n        <div className={isErrorOnLoad ? classNameOnError : className}>\r\n            {isErrorOnLoad &&\r\n                <Alert status=\"error\">\r\n                    <AlertIcon />\r\n                    <AlertTitle mr={2}>Loading error!</AlertTitle>\r\n                    <AlertDescription>The image {url} could not be loaded. Try with another URL.</AlertDescription>\r\n                </Alert>\r\n            }\r\n            {!isErrorOnLoad &&\r\n                <VStack>\r\n                    <canvas id={name} ref={canvasRef} />\r\n                    <Text fontSize=\"sm\">{label}</Text>\r\n                </VStack>\r\n            }\r\n        </div>\r\n    );\r\n}\r\n","import { useEffect, useRef } from 'react';\r\nimport { Context } from 'vm';\r\nimport {drawPolygon, Polygon} from \"./common/geometry\";\r\nimport { Text, VStack } from \"@chakra-ui/react\";\r\n\r\nexport interface RendererProps {\r\n    name: string;  \r\n    label: string;\r\n    width: number;\r\n    height: number;\r\n    ratioW: number;\r\n    ratioH: number;\r\n    drawingSteps: Polygon[];\r\n    className: string;\r\n};\r\n\r\nfunction draw(ctx: Context, width: number, height: number, ratioW: number, ratioH: number, drawingSteps: Polygon[] = []): void {    \r\n    ctx.clearRect(0, 0, width, height);\r\n    ctx.fillStyle = \"#000000\";\r\n    ctx.fillRect(0, 0, width, height);\r\n\r\n    ctx.scale(ratioW, ratioH);\r\n    drawingSteps.forEach(shape => {\r\n        drawPolygon(ctx, shape);\r\n    })\r\n}\r\n\r\nexport function RendererFromDrawing({ name, label, width, height, ratioW, ratioH, drawingSteps, className }: RendererProps) {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current as HTMLCanvasElement;\r\n        const ctx = canvas.getContext('2d');\r\n                \r\n        if (width === 0 || height === 0) {\r\n            console.error(\"Fail to create the drawing\");\r\n        }\r\n\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n\r\n        if (ctx) {            \r\n            draw(ctx, width, height, ratioW, ratioH, drawingSteps);\r\n        }\r\n        else {\r\n            console.error(\"ctx is null the drawing can not be done\");\r\n        }       \r\n    }, [width, height, ratioW, ratioH, drawingSteps]);\r\n\r\n    return (\r\n        <div>\r\n            <VStack>\r\n                <canvas className={className} id={name} ref={canvasRef} />\r\n                <Text fontSize=\"sm\">{label}</Text>\r\n            </VStack>\r\n        </div>\r\n    );    \r\n}\r\n","import { useEffect, useRef } from 'react';\r\nimport { Context } from 'vm';\r\nimport { Text, VStack } from '@chakra-ui/react';\r\n\r\nexport interface RendererProps {\r\n    name: string;  \r\n    label: string;\r\n    width: number;\r\n    height: number;\r\n    ratioW: number;\r\n    ratioH: number;\r\n    data: ImageData;\r\n    className: string;\r\n};\r\n\r\nfunction draw(ctx: Context, width: number, height: number, ratioW: number, ratioH: number, data: ImageData, canvas: HTMLCanvasElement): void {    \r\n    ctx.clearRect(0, 0, width, height);\r\n    ctx.putImageData(data, 0, 0);\r\n    ctx.scale(ratioW, ratioH);        \r\n    ctx.drawImage(canvas, 0, 0);    \r\n}\r\n\r\nexport function RendererFromData({ name, label, width, height, ratioW, ratioH, data, className }: RendererProps) {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current as HTMLCanvasElement;\r\n        const ctx = canvas.getContext('2d');\r\n                \r\n        if (width === 0 || height === 0) {\r\n            console.error(\"Fail to create the drawing\");\r\n        }\r\n\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n\r\n        if (ctx) {            \r\n            draw(ctx, width, height, ratioW, ratioH, data, canvas);\r\n        }\r\n        else {\r\n            console.error(\"ctx is null the drawing can not be done\");\r\n        }       \r\n    }, [width, height, ratioW, ratioH, data]);\r\n\r\n    return (\r\n        <div>          \r\n            <VStack>\r\n                <canvas className={className} id={name} ref={canvasRef} />\r\n                <Text fontSize=\"sm\">{label}</Text>\r\n            </VStack>\r\n        </div>\r\n    );    \r\n}\r\n","import { Table, Tbody, Td, Th, Thead, Tr } from \"@chakra-ui/table\";\r\n\r\nexport interface GAInfoProps {\r\n    generation: number;  \r\n    fitness: number;\r\n    ssim: number;\r\n    pixelDiff: number;\r\n    subPixel: number;\r\n    polygon: number;\r\n    idBest: number;\r\n    elapsedTimeForGeneration: number;\r\n    notImprovingSince: number;\r\n    nbPolygons: number;\r\n    className: string;\r\n};\r\n\r\nexport function GAInformation({ generation, fitness, ssim, pixelDiff, subPixel, polygon, idBest, elapsedTimeForGeneration, notImprovingSince, nbPolygons, className }: GAInfoProps) {\r\n    return (\r\n        <div className={className}>\r\n          <Table variant=\"striped\">\r\n            <Thead>\r\n              <Tr><Th> Simulation </Th></Tr>\r\n            </Thead>\r\n            <Tbody>\r\n            <Tr><Td>Generation:</Td><Td isNumeric>{generation}</Td></Tr>\r\n            <Tr><Td>Not improving since:</Td><Td isNumeric>{notImprovingSince}</Td></Tr>\r\n            <Tr><Td>Time by generation:</Td><Td isNumeric>{elapsedTimeForGeneration} seconds</Td></Tr>\r\n            <Tr><Td>Global fitness:</Td><Td isNumeric>{(fitness * 100.0).toFixed(2)}%</Td></Tr>\r\n            <Tr><Td>Ssim fitness:</Td><Td isNumeric>{(ssim * 100.0).toFixed(2)}%</Td></Tr>\r\n            <Tr><Td>Pixelmatch fitness:</Td><Td isNumeric>{(pixelDiff * 100.0).toFixed(2)}%</Td></Tr>\r\n            <Tr><Td>Sub Pixel fitness:</Td><Td isNumeric>{(subPixel * 100.0).toFixed(2)}%</Td></Tr>\r\n            <Tr><Td>Polygon fitness:</Td><Td isNumeric>{(polygon * 100.0).toFixed(2)}%</Td></Tr>\r\n            <Tr><Td>Best indivudial:</Td><Td isNumeric>{idBest}</Td></Tr>\r\n            <Tr><Td>Number of polygons:</Td><Td isNumeric>{nbPolygons}</Td></Tr>\r\n            </Tbody>\r\n          </Table>\r\n        </div>\r\n    );    \r\n}","import './InputRange.css';\r\nimport { useState } from \"react\";\r\nimport { Tooltip } from \"@chakra-ui/react\"\r\n\r\ninterface InputRangeProps {\r\n    defaultVal: number;\r\n    min: number;\r\n    max: number;\r\n    step: number;\r\n    label: string;\r\n    id: string;\r\n    name: string;\r\n    tooltip: string;\r\n    onChange: (val: number) => void\r\n}\r\n\r\nexport function InputRange({defaultVal, min, max, step, label, id, name, tooltip, onChange}: InputRangeProps) {\r\n    const [value, setValue] = useState<number>(defaultVal);\r\n\r\n    const handleOnChange = function(e: React.ChangeEvent<HTMLInputElement>) {\r\n        const newValue = e.target.valueAsNumber; \r\n        setValue(newValue);\r\n        onChange(newValue);\r\n    }\r\n\r\n    return (\r\n        <Tooltip label={tooltip} placement=\"top\" closeOnClick={false} bg=\"blue.50\" color=\"black\" offset={[0, -20]}>\r\n        <div className=\"inputrange-wrapper\">           \r\n            <label className=\"inputrange-one\">{label}</label>    \r\n            <input className=\"inputrange-two\" type=\"range\" id={id} name={name} min={min} max={max} step={step} value={value} onChange={handleOnChange}/>\r\n            <span className=\"inputrange-three\">{value}</span>\r\n        </div>    \r\n        </Tooltip>    \r\n    )\r\n}","import './GAConfiguration.css';\r\nimport { useEffect, useState } from \"react\";\r\nimport { Configuration } from \"./common/ga\";\r\nimport { InputRange } from \"./InputRange\"\r\nimport { Switch, Heading, VStack, Tooltip } from \"@chakra-ui/react\"\r\n\r\nexport interface InputRangeProps {\r\n    population: number;\r\n    parentSelectionStrategy: string;\r\n    selectCutoff: number;\r\n    tournamentSize: number;\r\n    keepPreviousRatio: number;\r\n    newIndividualRatio: number;\r\n    crossoverParentRatio: number;\r\n    mutationRate: number;\r\n    crossoverStrategy: string;\r\n    vertexMovement: number;\r\n    colorModificationRate: number;\r\n    copyColorNeighborRate: number;\r\n    addPolygonRate: number;\r\n    removePolygonRate: number;\r\n    enableSsim: boolean;\r\n    enablePixelDiff: boolean;\r\n    enableSubDiff: boolean;\r\n    ratioSsim: number;\r\n    ratioPixelDiff: number;\r\n    ratioSubDiff: number;\r\n    ratioPolygons: number;\r\n    enableTransparency: boolean;\r\n    nbVertex: number;\r\n    enableVariablePolygons: boolean;\r\n    nbPolygons: number;\r\n    resolution: number;\r\n    onValuesChange: (configuration: Configuration) => void;\r\n    className: string;\r\n}\r\n\r\nexport function GAConfiguration({\r\n    population,\r\n    parentSelectionStrategy,\r\n    selectCutoff,\r\n    tournamentSize,\r\n    keepPreviousRatio,\r\n    newIndividualRatio,\r\n    crossoverParentRatio,\r\n    mutationRate,\r\n    crossoverStrategy,\r\n    vertexMovement,\r\n    colorModificationRate,\r\n    copyColorNeighborRate,\r\n    addPolygonRate,\r\n    removePolygonRate,\r\n    enableSsim,\r\n    enablePixelDiff,\r\n    enableSubDiff,\r\n    ratioSsim,\r\n    ratioPixelDiff,\r\n    ratioSubDiff,\r\n    ratioPolygons,\r\n    enableTransparency,\r\n    nbVertex,\r\n    enableVariablePolygons,\r\n    nbPolygons,\r\n    resolution,\r\n    onValuesChange, className} : InputRangeProps) {\r\n    \r\n        const [values, setValues] = useState<Configuration>({\r\n            population: population,\r\n            parentSelectionStrategy: parentSelectionStrategy,\r\n            selectCutoff: selectCutoff,\r\n            tournamentSize: tournamentSize,\r\n            keepPreviousRatio: keepPreviousRatio,\r\n            newIndividualRatio: newIndividualRatio,\r\n            crossoverParentRatio: crossoverParentRatio,\r\n            mutationRate: mutationRate,\r\n            crossoverStrategy: crossoverStrategy,\r\n            vertexMovement: vertexMovement,\r\n            colorModificationRate: colorModificationRate,\r\n            copyColorNeighborRate: copyColorNeighborRate,\r\n            addPolygonRate: addPolygonRate,\r\n            removePolygonRate: removePolygonRate,\r\n            enableSsim: enableSsim,\r\n            enablePixelDiff: enablePixelDiff,\r\n            enableSubDiff: enableSubDiff,\r\n            ratioSsim: ratioSsim,\r\n            ratioPixelDiff: ratioPixelDiff,\r\n            ratioSubDiff: ratioSubDiff,\r\n            ratioPolygons: ratioPolygons,\r\n            enableTransparency: enableTransparency,\r\n            nbVertex: nbVertex,\r\n            enableVariablePolygons,\r\n            nbPolygons: nbPolygons,\r\n            resolution: resolution\r\n        });\r\n\r\n    useEffect(() => {\r\n        onValuesChange(values);\r\n    }, [values, onValuesChange]);\r\n\r\n    return (\r\n        <div className={className}>\r\n            <VStack spacing={6}>\r\n            <div>\r\n                <Heading as=\"h4\" size=\"sm\">General</Heading>\r\n                <InputRange id=\"ga-population\" name=\"ga-population\" label=\"Population\" tooltip=\"Number of individuals (solutions) evaluated at each generation\" min={10} max={300} defaultVal={values.population} step={1} onChange={v => setValues({...values, population: v})}/>\r\n                <InputRange id=\"ga-keep-previous\" name=\"ga-keep-previous\" label=\"Keep previous individual\" tooltip=\"Rate when building next generation to incorpore an individual from the previous generation\" min={0} max={1} defaultVal={values.keepPreviousRatio} step={0.01}onChange={v => setValues({...values, keepPreviousRatio: v})}/>\r\n                <InputRange id=\"ga-new-individual\" name=\"ga-new-individual\" label=\"Generate new individual\" tooltip=\"Rate when building next generation to incorpore a completely new random individual\" min={0} max={1} defaultVal={values.newIndividualRatio} step={0.01} onChange={v => setValues({...values, newIndividualRatio: v})}/>\r\n            </div>\r\n\r\n            <div>\r\n                <Heading as=\"h4\" size=\"sm\">Crossover</Heading>\r\n                <Tooltip label=\"The selection strategy to pick parents for generating the children of the next generation\" placement=\"top\" closeOnClick={false} bg=\"blue.50\" color=\"black\" offset={[0, -10]}>\r\n                <div className=\"gaconfiguration-wrapper\">\r\n                    <label className=\"gaconfiguration-one\">Type: </label> <br/>\r\n                    <div className=\"gaconfiguration-two\">\r\n                        <label className=\"ga-strategy-label\" htmlFor=\"strategy-tournament\">Tournament <br/> \r\n                            <input type=\"radio\" id=\"strategy-tournament\" name=\"parentstrategy\" value=\"tournament\" checked={values.parentSelectionStrategy === \"tournament\"} onChange={v =>{setValues({...values, parentSelectionStrategy: v.target.value})}}/>\r\n                        </label> \r\n\r\n                        <label className=\"ga-strategy-label\" htmlFor=\"strategy-fortunewheel\">Fortune Wheel <br/>\r\n                            <input type=\"radio\" id=\"strategy-fortunewheel\" name=\"parentstrategy\" value=\"fortunewheel\" checked={values.parentSelectionStrategy === \"fortunewheel\"} onChange={v =>{setValues({...values, parentSelectionStrategy: v.target.value})}}/>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                </Tooltip>\r\n            \r\n                {values.parentSelectionStrategy === \"tournament\" &&\r\n                    <InputRange id=\"ga-selection-cutoff\" name=\"ga-selection-cutoff\" label=\"Selection cutoff\" tooltip=\"Quantity of the population to be considered for creating the tournament pool\" min={0} max={1} defaultVal={values.selectCutoff} step={0.05} onChange={v => setValues({...values, selectCutoff: v})}/>                \r\n                }\r\n\r\n                {values.parentSelectionStrategy === \"tournament\" &&\r\n                    <InputRange id=\"ga-tournament-size\" name=\"ga-tournament-size\" label=\"Tournament size\" tooltip=\"Number of participants from the pool to participate in each tournament\" min={1} max={Math.round(values.selectCutoff * values.population)} defaultVal={values.tournamentSize} step={1} onChange={v => setValues({...values, tournamentSize: v})}/>\r\n                }\r\n\r\n                <InputRange id=\"ga-crossover-parent\" name=\"ga-crossover-parent\" label=\"Main parent ratio\" tooltip=\"Quantity of genes to keep from the parent with the highest fitness\" min={0} max={1} defaultVal={values.crossoverParentRatio} step={0.05} onChange={v => setValues({...values, crossoverParentRatio: v})}/>\r\n                <Tooltip label=\"The granularity used for the crossover of the two parents\" placement=\"top\" closeOnClick={false} bg=\"blue.50\" color=\"black\" offset={[0, -20]}>\r\n                <div className=\"gaconfiguration-wrapper\">\r\n                    <label className=\"gaconfiguration-one\">Granularity: </label> <br/>\r\n                    <div className=\"gaconfiguration-two\">\r\n                        <label className=\"ga-strategy-label\" htmlFor=\"strategy-polygon\">Polygons <br/>\r\n                            <input type=\"radio\" id=\"strategy-polygon\" name=\"strategy\" value=\"polygon\" checked={values.crossoverStrategy === \"polygon\"} onChange={v =>{setValues({...values, crossoverStrategy: v.target.value})}}/>\r\n                        </label> \r\n\r\n                        <label className=\"ga-strategy-label\" htmlFor=\"strategy-vertex\">Vertex <br/>\r\n                            <input type=\"radio\" id=\"strategy-vertex\" name=\"strategy\" value=\"vertex\" checked={values.crossoverStrategy === \"vertex\"} onChange={v =>{setValues({...values, crossoverStrategy: v.target.value})}}/>\r\n                        </label>\r\n\r\n                        <label className=\"ga-strategy-label\" htmlFor=\"strategy-data\">Data <br/>\r\n                            <input type=\"radio\" id=\"strategy-data\" name=\"strategy\" value=\"data\" checked={values.crossoverStrategy === \"data\"} onChange={v =>{setValues({...values, crossoverStrategy: v.target.value})}}/>\r\n                        </label>\r\n\r\n                        <label className=\"ga-strategy-label\" htmlFor=\"strategy-singlePoint\">Single point <br/>\r\n                            <input type=\"radio\" id=\"strategy-singlePoint\" name=\"strategy\" value=\"singlePoint\" checked={values.crossoverStrategy === \"singlePoint\"} onChange={v =>{setValues({...values, crossoverStrategy: v.target.value})}}/>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                </Tooltip>\r\n            </div>\r\n            \r\n            <div>\r\n                <Heading as=\"h4\" size=\"sm\">Mutation</Heading>\r\n                <InputRange id=\"ga-mutation\" name=\"ga-mutation\" label=\"Mutation rate\" tooltip=\"Rate of mutation applied to each gene of an individual\" min={0} max={1} defaultVal={values.mutationRate} step={0.01} onChange={v => setValues({...values, mutationRate: v})}/>\r\n                <InputRange id=\"ga-vertex-movement\" name=\"ga-vertex-movement\" label=\"Vertex movement\" tooltip=\"Maximum pourcentage of the image resolution to use as range for moving a vertex during mutation\" min={0} max={0.5} defaultVal={values.vertexMovement} step={0.01} onChange={v => setValues({...values, vertexMovement: v})}/>\r\n                <InputRange id=\"ga-color-modification\" name=\"ga-color-modification\" label=\"Color modification\" tooltip=\"Maximum pourcentage for changing a color component during mutation\" min={0} max={1} defaultVal={values.colorModificationRate} step={0.01} onChange={v => setValues({...values, colorModificationRate: v})}/>\r\n                <InputRange id=\"ga-color-copy\" name=\"ga-color-copy\" label=\"Copy neighbor color\" min={0} max={1} tooltip=\"Rate when mutating color to get the color from the closest neighbor than changing the value by a percentage\" defaultVal={values.copyColorNeighborRate} step={0.01} onChange={v => setValues({...values, copyColorNeighborRate: v})}/>\r\n                <InputRange id=\"ga-add-polygon\" name=\"ga-add-polygon\" label=\"Add polygon\" min={0} max={1} tooltip=\"Rate when mutating polygon to insert an additional polygon (variable number of polygons should be enabled) \" defaultVal={values.addPolygonRate} step={0.01} onChange={v => setValues({...values, addPolygonRate: v})}/>\r\n                <InputRange id=\"ga-remove-polygon\" name=\"ga-remove-polygon\" label=\"Remove polygon\" min={0} max={1} tooltip=\"Rate when mutation polygon to remove the current polygon (variable number of polygons should be enabled)\" defaultVal={values.removePolygonRate} step={0.01} onChange={v => setValues({...values, removePolygonRate: v})}/>\r\n            </div>\r\n            \r\n            <div>\r\n                <Heading as=\"h4\" size=\"sm\">Image rendering</Heading>\r\n                <InputRange id=\"ga-resolution\" name=\"ga-resolution\" label=\"resolution\" tooltip=\"Resolution used for the original image during simulation (less for faster computing but less rendering quality)\" min={32} max={256} defaultVal={values.resolution} step={32} onChange={v => setValues({...values, resolution: v})}/>\r\n                <Tooltip label=\"Enable the Ssim fitness function (help to build the image's structure)\" placement=\"top\" closeOnClick={false} bg=\"blue.50\" color=\"black\" offset={[0, -20]}>\r\n                <div>\r\n                    <label htmlFor=\"ga-ssim\">SSIM:</label>\r\n                    <Switch className=\"ga-chakra-switch\" id=\"ga-ssim\" value=\"ssim\" isChecked={values.enableSsim} onChange={v =>{setValues({...values, enableSsim: v.target.checked})}}/>\r\n                </div>\r\n                </Tooltip>\r\n                <Tooltip label=\"Enable the Pixelmatch fitness function (help to fit the colors, consider as well other image's attributes)\" placement=\"top\" closeOnClick={false} bg=\"blue.50\" color=\"black\" offset={[0, -20]}>\r\n                <div>            \r\n                    <label htmlFor=\"ga-pixeldiff\">Pixel differenciation:</label>\r\n                    <Switch className=\"ga-chakra-switch\" id=\"ga-pixeldiff\" value=\"pixeldiff\" isChecked={values.enablePixelDiff} onChange={v => setValues({...values, enablePixelDiff: v.target.checked})}/>\r\n                </div>\r\n                </Tooltip>\r\n                <Tooltip label=\"Enable the average difference between pixels fitness function (help to fit the colors)\" placement=\"top\" closeOnClick={false} bg=\"blue.50\" color=\"black\" offset={[0, -20]}>\r\n                <div>            \r\n                    <label htmlFor=\"ga-subdiff\">Pixel substraction:</label>\r\n                    <Switch className=\"ga-chakra-switch\" id=\"ga-subdiff\" value=\"subdiff\" isChecked={values.enableSubDiff} onChange={v => setValues({...values, enableSubDiff: v.target.checked})}/>\r\n                </div>\r\n                </Tooltip>\r\n                <Tooltip label=\"Enable the action to add / remove a polygon from an individual\" placement=\"top\" closeOnClick={false} bg=\"blue.50\" color=\"black\" offset={[0, -20]}>\r\n                <div>   \r\n                    <label htmlFor=\"ga-enableVariablePolygons\">Variable number of polygons:</label>\r\n                    <Switch className=\"ga-chakra-switch\" id=\"ga-enableVariablePolygons\" value=\"enableVariablePolygons\" isChecked={values.enableVariablePolygons} onChange={v => setValues({...values, enableVariablePolygons: v.target.checked})}/>\r\n                </div>\r\n                </Tooltip>\r\n                {values.enableSsim &&\r\n                    <InputRange id=\"ga-ssim-ratio\" name=\"ga-ssim-ratio\" label=\"Ratio Ssim\" tooltip=\"Weight for computing the global fitness\" min={0} max={10} defaultVal={values.ratioSsim} step={0.1} onChange={v => setValues({...values, ratioSsim: v})}/>\r\n                }\r\n                {values.enablePixelDiff && \r\n                    <InputRange id=\"ga-pixldiff-ratio\" name=\"ga-pixldiff-ration\" label=\"Ratio Pixelmatch\" tooltip=\"Weight for computing the global fitness\" min={0} max={10} defaultVal={values.ratioPixelDiff} step={0.1} onChange={v => setValues({...values, ratioPixelDiff: v})}/>\r\n                }\r\n                {values.enableSubDiff &&\r\n                    <InputRange id=\"ga-subdiff-ratio\" name=\"ga-subdiff-ration\" label=\"Ratio Sub diff\" tooltip=\"Weight for computing the global fitness\" min={0} max={10} defaultVal={values.ratioSubDiff} step={0.1} onChange={v => setValues({...values, ratioSubDiff: v})}/>            \r\n                }\r\n                {values.enableVariablePolygons &&\r\n                    <InputRange id=\"ga-polygons-ratio\" name=\"ga-polygons-ration\" label=\"Ratio polygons\" tooltip=\"Weight for computing the global fitness\" min={0} max={10} defaultVal={values.ratioPolygons} step={0.1} onChange={v => setValues({...values, ratioPolygons: v})}/>            \r\n                }\r\n            \r\n               <Tooltip label=\"Enable the transparency when drawing the polygons\" placement=\"top\" closeOnClick={false} bg=\"blue.50\" color=\"black\" offset={[0, -20]}>\r\n                <div>   \r\n                    <label htmlFor=\"ga-transparency\">Transparency:</label>\r\n                    <Switch className=\"ga-chakra-switch\" id=\"ga-transparency\" value=\"transparency\" isChecked={values.enableTransparency} onChange={v => setValues({...values, enableTransparency: v.target.checked})}/>\r\n                </div>\r\n                </Tooltip>\r\n\r\n                <InputRange id=\"ga-vertex\" name=\"ga-vertex\" label=\"Vertex\" tooltip=\"Number of vertex for the polygons used for the drawing (3 is a triangle)\" min={3} max={10} defaultVal={values.nbVertex} step={1} onChange={v => setValues({...values, nbVertex: v})}/>\r\n                <InputRange id=\"ga-vertices\" name=\"ga-vertices\" label=\"Vertices\" tooltip=\"Number of polygons used for the drawing (this number is fixed during the evolution)\" min={1} max={500} defaultVal={values.nbPolygons} step={1} onChange={v => setValues({...values, nbPolygons: v})}/>\r\n            </div>\r\n            </VStack>\r\n        </div>\r\n    )\r\n}","import { VStack } from \"@chakra-ui/layout\";\r\nimport { Table, Tbody, Td, Th, Thead, Tr } from \"@chakra-ui/table\";\r\n\r\nexport interface InputRangeProps {\r\n    population: number;\r\n    parentSelectionStrategy: string;\r\n    selectCutoff: number;\r\n    tournamentSize: number;\r\n    keepPreviousRatio: number;\r\n    newIndividualRatio: number;\r\n    crossoverParentRatio: number;\r\n    mutationRate: number;\r\n    crossoverStrategy: string;\r\n    vertexMovement: number;\r\n    colorModificationRate: number;\r\n    copyColorNeighborRate: number;\r\n    addPolygonRate: number;\r\n    removePolygonRate: number;\r\n    enableSsim: boolean;\r\n    enablePixelDiff: boolean;\r\n    enableSubDiff: boolean;\r\n    ratioSsim: number;\r\n    ratioPixelDiff: number;\r\n    ratioSubDiff: number;\r\n    ratioPolygons: number;\r\n    enableTransparency: boolean;\r\n    nbVertex: number;\r\n    enableVariablePolygons: boolean;\r\n    nbPolygons: number;\r\n    resolution: number;\r\n    className: string;\r\n}\r\n\r\nexport function GAConfigurationInfo({\r\n    population,\r\n    parentSelectionStrategy,\r\n    selectCutoff,\r\n    tournamentSize,\r\n    keepPreviousRatio,\r\n    newIndividualRatio,\r\n    crossoverParentRatio,\r\n    mutationRate,\r\n    crossoverStrategy,\r\n    vertexMovement,\r\n    colorModificationRate,\r\n    copyColorNeighborRate,\r\n    addPolygonRate,\r\n    removePolygonRate,\r\n    enableSsim,\r\n    enablePixelDiff,\r\n    enableSubDiff,\r\n    ratioSsim,\r\n    ratioPixelDiff,\r\n    ratioSubDiff,\r\n    ratioPolygons,\r\n    enableTransparency,\r\n    nbVertex,\r\n    enableVariablePolygons,\r\n    nbPolygons,\r\n    resolution,\r\n    className}: InputRangeProps) {\r\n\r\n    const generateTournamentInforation = (): JSX.Element[] => {\r\n        const elements: JSX.Element[] = []; \r\n        elements.push(<Tr key=\"tr-1\"><Td> Selection cutoff:</Td><Td isNumeric>{selectCutoff}</Td></Tr>);\r\n        elements.push(<Tr key=\"tr-2\"><Td> Tournament size::</Td><Td isNumeric>{tournamentSize}</Td></Tr>);\r\n        return elements;               \r\n    }\r\n\r\n    const generateFitnessEngineInformation = (): JSX.Element[] => {\r\n        const enabledEngines: string[] = [];\r\n\r\n        if (enableSsim) {\r\n            enabledEngines.push(\"Ssim (\" + ratioSsim + \")\");\r\n        }\r\n\r\n        if (enablePixelDiff) {\r\n            enabledEngines.push(\"Pixel diff (\" + ratioPixelDiff + \")\");\r\n        }\r\n\r\n        if (enableSubDiff) {\r\n            enabledEngines.push(\"Sub diff (\" + ratioSubDiff + \")\");\r\n        }\r\n\r\n        if (enableVariablePolygons) {\r\n            enabledEngines.push(\"Polygons (\" + ratioPolygons + \")\");\r\n        }\r\n        \r\n        const elements: JSX.Element[] = [];\r\n        elements.push(<Tr key=\"tr-3\"><Td> Fitness functions:</Td><Td isNumeric>{enabledEngines.join(', ')}</Td></Tr>);\r\n        return elements;\r\n    }\r\n\r\n    return (\r\n        <div className={className}>\r\n            <VStack spacing={6}>\r\n            <Table variant=\"striped\">\r\n                <Thead>\r\n                    <Tr><Th>General</Th></Tr>\r\n                </Thead>\r\n                <Tbody>                \r\n                <Tr><Td>Population size: </Td><Td isNumeric>{population}</Td></Tr>\r\n                <Tr><Td>Keep from previous generation: </Td><Td isNumeric>{keepPreviousRatio * 100}% </Td></Tr>\r\n                <Tr><Td>Insert new individual in generation: </Td><Td isNumeric>{newIndividualRatio * 100}% </Td></Tr>\r\n                </Tbody>\r\n            </Table>\r\n\r\n            <Table variant=\"striped\">\r\n                <Thead>\r\n                    <Tr><Th>Crossover</Th></Tr>\r\n                </Thead>\r\n                <Tbody>\r\n                <Tr><Td>Parent selection strategy:</Td><Td isNumeric>{parentSelectionStrategy}</Td></Tr>\r\n                {generateTournamentInforation()}\r\n                <Tr><Td>Main parent ratio during crossover :</Td><Td isNumeric>{crossoverParentRatio * 100}%</Td></Tr>\r\n                <Tr><Td>Crossover strategy :</Td><Td isNumeric>{crossoverStrategy}</Td></Tr>\r\n                </Tbody>\r\n            </Table>\r\n\r\n            <Table variant=\"striped\">\r\n                <Thead>\r\n                   <Tr><Th>Mutation</Th></Tr> \r\n                </Thead>\r\n                <Tbody>    \r\n                <Tr><Td>Mutation rate :</Td><Td isNumeric>{mutationRate * 100}%</Td></Tr>\r\n                <Tr><Td>Copy neighbor color rate :</Td><Td isNumeric>{copyColorNeighborRate * 100}%</Td></Tr>                \r\n                <Tr><Td>Vertex movement during mutation :</Td><Td isNumeric>{vertexMovement * 100}%</Td></Tr>\r\n                <Tr><Td>Color movement during mutation :</Td><Td isNumeric>{colorModificationRate * 100}%</Td></Tr>\r\n                <Tr><Td>Add polygon during mutation :</Td><Td isNumeric>{addPolygonRate * 100}%</Td></Tr>\r\n                <Tr><Td>Remove polygon during mutation :</Td><Td isNumeric>{removePolygonRate * 100}%</Td></Tr>\r\n                </Tbody>\r\n            </Table>\r\n\r\n            <Table variant=\"striped\">\r\n                <Thead>\r\n                    <Tr><Th>Image rendering</Th></Tr>\r\n                </Thead>\r\n                <Tbody>               \r\n                <Tr><Td>Resolution :</Td><Td isNumeric>{resolution}px</Td></Tr>                  \r\n                {generateFitnessEngineInformation()}\r\n                <Tr><Td>Transparency enabled :</Td><Td isNumeric>{enableTransparency}</Td></Tr>\r\n                <Tr><Td>Variable number of polygons:</Td><Td isNumeric>{enableVariablePolygons}</Td></Tr>\r\n                <Tr><Td>Vertex by polygon :</Td><Td isNumeric>{nbVertex}</Td></Tr>\r\n                <Tr><Td>Generated polygons :</Td><Td isNumeric>{nbPolygons}</Td></Tr>         \r\n                </Tbody>   \r\n            </Table>\r\n            </VStack>\r\n        </div>\r\n    )\r\n}","import './MyApp.css';\r\nimport {useState, useCallback, useEffect} from \"react\";\r\n\r\nimport MyWorker from './test.worker';\r\nimport {AGworkerIn, AGworkerOut} from \"./common/communication\";\r\nimport { getLimitDimensions, Image } from './common/geometry';\r\nimport { InputImageUrl } from './InputImageUrl';\r\nimport { RendererFromUrl } from './RendererFromUrl';\r\nimport { RendererFromDrawing } from './RendererFromDrawing';\r\nimport { RendererFromData } from './RendererFromData';\r\nimport { GAInformation } from './GAInformation';\r\nimport { GAConfiguration } from './GAConfiguration';\r\nimport { Configuration } from './common/ga';\r\nimport { GAConfigurationInfo } from './GAConfigurationInfo';\r\n\r\nimport { Tabs, TabList, TabPanels, Tab, TabPanel } from \"@chakra-ui/react\"\r\n\r\nfunction MyApp() {\r\n\r\n  const limitImageSize = 256;\r\n  const sampleLnks: {name: string, link: string}[] = [\r\n    { \r\n      name: \"Einstein\",\r\n      link: \"https://raw.githubusercontent.com/obartra/ssim/master/spec/samples/einstein/Q1.gif\"\r\n    },\r\n    { \r\n      name: \"Joconde\",\r\n      link: \"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/390px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg\"\r\n    },\r\n    { \r\n      name: \"Photographer\",\r\n      link: \"https://i.picsum.photos/id/823/420/560.jpg?hmac=H6lJE4fRi96MxgWYyd3_79WbmObu-jJj7Zo40p5I-nU\"\r\n    },\r\n    { \r\n      name: \"Landscape\",\r\n      link: \"https://i.picsum.photos/id/1015/420/560.jpg?hmac=JcSYiOeUMQYq_XstyekCWyhAlg_e8UiPWxp66v-ki6Q\"\r\n    },\r\n    { \r\n      name: \"Random\",\r\n      link: \"https://picsum.photos/420/560\"\r\n    }       \r\n  ];\r\n\r\n  const [configuration, setConfiguration] = useState<Configuration>({\r\n    population: 50,\r\n    parentSelectionStrategy: \"tournament\",\r\n    selectCutoff: 0.2,\r\n    tournamentSize: 3,\r\n    keepPreviousRatio: 0.01,\r\n    newIndividualRatio: 0.01,\r\n    crossoverParentRatio: 0.6,\r\n    mutationRate: 0.01,\r\n    crossoverStrategy: \"polygon\",\r\n    vertexMovement: 0.15,\r\n    colorModificationRate: 0.1,\r\n    copyColorNeighborRate: 0.01,\r\n    addPolygonRate: 0.1,\r\n    removePolygonRate: 0.1,\r\n    enableSsim: true,\r\n    enablePixelDiff: false,\r\n    enableSubDiff: false,    \r\n    enableVariablePolygons: true,\r\n    ratioSsim: 1,\r\n    ratioPixelDiff: 1,\r\n    ratioSubDiff: 1,\r\n    ratioPolygons: 0.05,\r\n    enableTransparency: true,\r\n    nbVertex: 3,\r\n    nbPolygons: 26,\r\n    resolution: 64\r\n  });\r\n\r\n  const [simulation, setSimulation] = useState<AGworkerOut>({\r\n    isRunning: false,\r\n    best: {\r\n      genes: [],\r\n      fitness: 0,\r\n      ssim: 0,\r\n      pixelDiff: 0,\r\n      subPixel: 0,\r\n      polygon: 0,\r\n      diff: undefined,\r\n      id: 0,\r\n      probability: 0,\r\n      phenotype: []\r\n    },\r\n    population: [],\r\n    generation: 0,\r\n    elapsedTime: 0,\r\n    notImprovingSince: 0\r\n  });\r\n\r\n  const [response, setResponse] = useState<AGworkerOut | undefined>(undefined);\r\n\r\n  const [imageUrl, setUrl] = useState<string>(\"\");\r\n  const [imageFromUrl, setImage] = useState<Image>({\r\n    image: null, renderedWidth: 0, renderedHeight: 0, ratioOffscreenWidth: 0, ratioOffscreenHeight: 0, offscreenWidth: 0, offscreenHeight: 0, limitOffscreen: 0});\r\n\r\n  const [myWorkerInstance, setWorker] = useState<Worker | null>(null); \r\n  const [isStopped, setStop] = useState<boolean>(true);\r\n\r\n  const handleResponse = useCallback((e: MessageEvent<any>) => {      \r\n    const response: AGworkerOut = e.data as AGworkerOut;\r\n    setResponse(response);             \r\n  }, []);\r\n\r\n  const handleStart = useCallback((url :string) => {    \r\n    const newWorker = new MyWorker();    \r\n    setWorker(newWorker);\r\n\r\n    setStop(false);      \r\n    setUrl(url);    \r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (myWorkerInstance) {\r\n      console.log(\"Add listener to worker\");\r\n      myWorkerInstance.addEventListener('message', handleResponse);\r\n    }    \r\n  }, [myWorkerInstance, handleResponse]);\r\n\r\n  useEffect(() => {\r\n\r\n    if (!myWorkerInstance || !imageFromUrl.image || !response || isStopped) {\r\n      return;\r\n    }\r\n\r\n    //if ((simulation.generation + 1) === response.generation) {\r\n      setSimulation(response);\r\n      //console.log(`Set response of generation ${response.generation}`);\r\n\r\n      //Send next message\r\n      const message: AGworkerIn = {\r\n        isRunning: response.isRunning,\r\n        image: imageFromUrl.image, \r\n        configuration: configuration,\r\n        notImprovingSince: response.notImprovingSince,\r\n        best: response.best,\r\n        population: response.population,\r\n        generation: response.generation,\r\n        renderingHeight: imageFromUrl.offscreenHeight,\r\n        renderingWidth: imageFromUrl.offscreenWidth\r\n      };\r\n\r\n      myWorkerInstance.postMessage(message);\r\n    /*\r\n    }\r\n    else {\r\n      console.warn(`Try to set response of generation ${response.generation} to simulation of generation ${simulation.generation}`);\r\n    } \r\n    */       \r\n  }, [myWorkerInstance, response, imageFromUrl, configuration, isStopped])\r\n\r\n  const handleStop = useCallback(() => {\r\n    // Reset simulation\r\n    if (myWorkerInstance) {\r\n      myWorkerInstance.terminate();\r\n      setSimulation({\r\n        isRunning: false,\r\n        best: {\r\n          genes: [],\r\n          fitness: 0,\r\n          ssim: 0,\r\n          pixelDiff: 0,\r\n          subPixel: 0,\r\n          polygon: 0,\r\n          diff: undefined,\r\n          id: 0,\r\n          probability: 0,\r\n          phenotype: []\r\n        },\r\n        population: [],\r\n        generation: 0,\r\n        elapsedTime: 0,\r\n        notImprovingSince: 0\r\n      });\r\n      setUrl(\"\");  \r\n      setStop(true); \r\n      setResponse(undefined);        \r\n    }    \r\n  }, [myWorkerInstance]);\r\n\r\n  const handleUrlImageDrawn = useCallback((img: CanvasImageSource, renderedWidth: number, renderedHeight: number) => {\r\n    const imageWidth: number = img.width as number;\r\n    const imageHeight: number = img.height as number;\r\n\r\n    const simDimensions = getLimitDimensions(imageWidth, imageHeight, configuration.resolution);  \r\n    const ratioW = simDimensions.width / renderedWidth;\r\n    const ratioH = simDimensions.height / renderedHeight; \r\n\r\n    const canvas = new OffscreenCanvas(simDimensions.width, simDimensions.height); \r\n    const ctx = canvas.getContext('2d');\r\n    if (ctx) {      \r\n      // Rescale the image for the simulation\r\n      ctx.scale(ratioW, ratioH);\r\n      ctx.drawImage(img, 0, 0, renderedWidth, renderedHeight);\r\n      const image = ctx.getImageData(0, 0, simDimensions.width, simDimensions.height);\r\n      \r\n      setImage({\r\n        image: image,\r\n        renderedWidth: renderedWidth,\r\n        renderedHeight: renderedHeight,\r\n        offscreenWidth: simDimensions.width,\r\n        offscreenHeight: simDimensions.height,\r\n        ratioOffscreenWidth: ratioW,\r\n        ratioOffscreenHeight: ratioH,\r\n        limitOffscreen: configuration.resolution\r\n      });  \r\n\r\n      if (myWorkerInstance && image) {\r\n        //Send next message\r\n        const message: AGworkerIn = {\r\n          isRunning: simulation.isRunning,\r\n          image: image, \r\n          configuration: configuration,\r\n          notImprovingSince: simulation.notImprovingSince,\r\n          best: simulation.best,\r\n          population: simulation.population,\r\n          generation: simulation.generation,\r\n          renderingHeight: simDimensions.height,\r\n          renderingWidth: simDimensions.width\r\n        };\r\n\r\n        console.log(\"post message for first generation\");\r\n        myWorkerInstance.postMessage(message);\r\n      }     \r\n\r\n    } \r\n    else {\r\n      console.error(\"ctx from url image for resizing could not be created\");\r\n    }   \r\n  }, [simulation, myWorkerInstance, configuration]);\r\n\r\n  const handleLoadingImageError = useCallback(() => {\r\n    setStop(true);  \r\n  }, []);\r\n\r\n  const handleValuesChange = useCallback((config: Configuration) => {   \r\n    setConfiguration(config);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"wrapper\">       \r\n      <InputImageUrl className=\"one\" links={sampleLnks} start={handleStart} stop={handleStop} isStopped={isStopped}/>\r\n      { imageUrl &&\r\n        <RendererFromUrl className=\"two\" classNameOnError=\"twoExpanded\" name={\"original-image\"} label=\"Original\" onImageDrawn={handleUrlImageDrawn} onLoadingError={handleLoadingImageError} limit={limitImageSize} url={imageUrl}/>\r\n      }\r\n      { imageFromUrl.image && !isStopped &&\r\n        <RendererFromData className=\"three\" name={\"simu-image\"} label=\"In memory\" width={imageFromUrl.renderedWidth} height={imageFromUrl.renderedHeight} ratioW={1 / imageFromUrl.ratioOffscreenWidth} ratioH={1 / imageFromUrl.ratioOffscreenHeight} data={imageFromUrl.image}/>        \r\n      }\r\n      { imageFromUrl.image && !isStopped &&\r\n        <RendererFromDrawing className=\"four\" name={\"generated-image\"} label=\"Maestro painting\" width={imageFromUrl.renderedWidth} height={imageFromUrl.renderedHeight} ratioW={1 / imageFromUrl.ratioOffscreenWidth} ratioH={1 / imageFromUrl.ratioOffscreenHeight} drawingSteps={simulation.best.phenotype}/>        \r\n      }\r\n      { simulation.best.diff && !isStopped &&\r\n        <RendererFromData className=\"five\" name={\"diff-image\"} label=\"Memory VS Painting\" width={imageFromUrl.renderedWidth} height={imageFromUrl.renderedHeight} ratioW={1 / imageFromUrl.ratioOffscreenWidth} ratioH={1 / imageFromUrl.ratioOffscreenHeight} data={simulation.best.diff}/>        \r\n      }\r\n      \r\n      {!isStopped &&\r\n          <div className=\"six\">\r\n          <Tabs>\r\n          <TabList>\r\n            <Tab>Painting Art</Tab>\r\n            <Tab>Genetic Algorithm parameters</Tab>\r\n          </TabList>\r\n\r\n          <TabPanels>\r\n            <TabPanel>\r\n              <GAInformation \r\n                className=\"\" \r\n                generation={simulation.generation} \r\n                fitness={simulation.best.fitness} \r\n                ssim={simulation.best.ssim}\r\n                pixelDiff={simulation.best.pixelDiff}\r\n                subPixel={simulation.best.subPixel}\r\n                polygon={simulation.best.polygon}\r\n                idBest={simulation.best.id} \r\n                elapsedTimeForGeneration={simulation.elapsedTime}\r\n                notImprovingSince={simulation.notImprovingSince}\r\n                nbPolygons={simulation.best.genes.length / 10}\r\n              />\r\n            </TabPanel>\r\n            <TabPanel>\r\n              <GAConfigurationInfo \r\n                population={configuration.population}\r\n                parentSelectionStrategy={configuration.parentSelectionStrategy}\r\n                selectCutoff={configuration.selectCutoff}\r\n                tournamentSize={configuration.tournamentSize}\r\n                keepPreviousRatio={configuration.keepPreviousRatio}\r\n                newIndividualRatio={configuration.newIndividualRatio}\r\n                crossoverParentRatio={configuration.crossoverParentRatio}\r\n                mutationRate={configuration.mutationRate}\r\n                crossoverStrategy={configuration.crossoverStrategy}\r\n                vertexMovement={configuration.vertexMovement}\r\n                colorModificationRate={configuration.colorModificationRate}\r\n                copyColorNeighborRate={configuration.copyColorNeighborRate}\r\n                addPolygonRate={configuration.addPolygonRate}\r\n                removePolygonRate={configuration.removePolygonRate}\r\n                enableSsim={configuration.enableSsim}\r\n                enablePixelDiff={configuration.enablePixelDiff}\r\n                enableSubDiff={configuration.enableSubDiff}\r\n                ratioSsim={configuration.ratioSsim}\r\n                ratioPixelDiff={configuration.ratioPixelDiff}\r\n                ratioSubDiff={configuration.ratioSubDiff}\r\n                ratioPolygons={configuration.ratioPolygons}\r\n                enableTransparency={configuration.enableTransparency}\r\n                nbVertex={configuration.nbVertex}\r\n                enableVariablePolygons={configuration.enableVariablePolygons}\r\n                nbPolygons={configuration.nbPolygons}\r\n                resolution={configuration.resolution}\r\n                className=\"\" \r\n              /> \r\n            </TabPanel>\r\n          </TabPanels>\r\n        </Tabs>\r\n        </div>\r\n      }\r\n\r\n      {isStopped &&\r\n        <GAConfiguration\r\n          population={configuration.population}\r\n          parentSelectionStrategy={configuration.parentSelectionStrategy}\r\n          selectCutoff={configuration.selectCutoff}\r\n          tournamentSize={configuration.tournamentSize}\r\n          keepPreviousRatio={configuration.keepPreviousRatio}\r\n          newIndividualRatio={configuration.newIndividualRatio}\r\n          crossoverParentRatio={configuration.crossoverParentRatio}\r\n          mutationRate={configuration.mutationRate}\r\n          crossoverStrategy={configuration.crossoverStrategy}\r\n          vertexMovement={configuration.vertexMovement}\r\n          colorModificationRate={configuration.colorModificationRate}\r\n          copyColorNeighborRate={configuration.copyColorNeighborRate}\r\n          addPolygonRate={configuration.addPolygonRate}\r\n          removePolygonRate={configuration.removePolygonRate}\r\n          enableSsim={configuration.enableSsim}\r\n          enablePixelDiff={configuration.enablePixelDiff}\r\n          enableSubDiff={configuration.enableSubDiff}          \r\n          enableVariablePolygons={configuration.enableVariablePolygons}\r\n          ratioSsim={configuration.ratioSsim}\r\n          ratioPixelDiff={configuration.ratioPixelDiff}\r\n          ratioSubDiff={configuration.ratioSubDiff}\r\n          ratioPolygons={configuration.ratioPolygons}\r\n          enableTransparency={configuration.enableTransparency}\r\n          nbVertex={configuration.nbVertex}\r\n          nbPolygons={configuration.nbPolygons}\r\n          resolution={configuration.resolution}\r\n          className=\"six\" \r\n          onValuesChange={handleValuesChange}\r\n        />\r\n      }      \r\n    </div>            \r\n  );\r\n}\r\n\r\nexport default MyApp;\r\n","import { ChakraProvider } from \"@chakra-ui/react\"\nimport { render } from \"react-dom\";\nimport MyApp from \"./MyApp\"\n\nconst rootElement = document.getElementById(\"root\");\nrender(\n  <ChakraProvider>\n    <MyApp />\n  </ChakraProvider>,\n  rootElement\n);"],"sourceRoot":""}