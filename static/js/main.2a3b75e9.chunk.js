(this.webpackJsonpreact_ag_image=this.webpackJsonpreact_ag_image||[]).push([[0],{87:function(e,t,n){},88:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var a=n(123),i=n(35),o=n(3),r=(n(87),n(0));function c(){return new Worker(n.p+"static/js/test.worker.bfc21add.js")}n(12);var s=n(4);function l(e){return 3===e.length?"rgb(".concat(e[0],",").concat(e[1],",").concat(e[2],")"):"rgba(".concat(e[0],",").concat(e[1],",").concat(e[2],",").concat(e[3],")")}function b(e,t){if(e&&0!==t.vertices.length){e.fillStyle=l(t.color),e.beginPath();var n=t.vertices[0];e.moveTo(n.x,n.y);for(var a=1;a<t.vertices.length;a++)n=t.vertices[a],e.lineTo(n.x,n.y);e.closePath(),e.fill()}}function d(e,t,n){var a=t/e;return n&&(e>=n||t>=n)?a>1?{width:Math.round(n/a),height:n,ratio:a}:{width:n,height:Math.round(n*a),ratio:a}:{width:e,height:t,ratio:a}}n(88);var j=n(124),u=n(125),g=n(126),h=n(1);function f(e){var t=e.start,n=e.stop,a=e.links,i=e.isStopped,c=e.className,s=Object(r.useState)("https://my-image-url"),l=Object(o.a)(s,2),b=l[0],d=l[1];return Object(h.jsxs)("div",{className:c,children:[Object(h.jsx)("div",{children:Object(h.jsx)("form",{onSubmit:function(e){e.preventDefault(),t&&t(b)},children:Object(h.jsxs)(u.a,{direction:"row",spacing:4,align:"center",children:[Object(h.jsx)(g.a,{type:"text",name:"image-url",value:b,onChange:function(e){return d(e.target.value)}}),Object(h.jsx)(j.a,{disabled:!i,type:"submit",id:"start-button",children:"Start"}),Object(h.jsx)(j.a,{disabled:i,type:"button",id:"stop-button",onClick:function(){n&&n()},children:"Stop"})]})})}),Object(h.jsx)("div",{children:Object(h.jsx)(u.a,{direction:"row",spacing:4,align:"center",children:function(){var e=[];return a.forEach((function(t){var n=Object(h.jsxs)(j.a,{variant:"link",value:t.link,onClick:function(e){d(e.currentTarget.value)},children:[" ",t.name," "]},t.name);e.push(n)})),e}()})})]})}n(94);var m=n(127),x=n(118);function O(e){var t=e.name,n=e.url,a=e.label,i=e.limit,c=e.onImageDrawn,s=e.onLoadingError,l=e.className,b=e.classNameOnError,j=Object(r.useRef)(null),g=Object(r.useState)(!1),f=Object(o.a)(g,2),O=f[0],p=f[1],v=Object(r.useState)(""),y=Object(o.a)(v,2),S=y[0],P=y[1];return Object(r.useEffect)((function(){if(n!==S){P(n),p(!1);var e=j.current;if(e){var t=e.getContext("2d"),a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var n=d(a.width,a.height,i),o=n.width,r=n.height;0!==o&&0!==r||console.error("Fail to load the image"),e.width=o,e.height=r,t?(t.drawImage(a,0,0,o,r),null===c||void 0===c||c(a,o,r)):console.error("ctx is null the image can not be loaded")},a.src=n,a.onerror=function(){p(!0),s()}}}}),[n,i,c,s,S]),Object(h.jsxs)("div",{className:O?b:l,children:[O&&Object(h.jsxs)(m.a,{status:"error",children:[Object(h.jsx)(m.c,{}),Object(h.jsx)(m.d,{mr:2,children:"Loading error!"}),Object(h.jsxs)(m.b,{children:["The image ",n," could not be loaded. Try with another URL."]})]}),!O&&Object(h.jsxs)(u.b,{children:[Object(h.jsx)("canvas",{id:t,ref:j}),Object(h.jsx)(x.a,{fontSize:"sm",children:a})]})]})}function p(e){var t=e.name,n=e.label,a=e.width,i=e.height,o=e.ratioW,c=e.ratioH,s=e.drawingSteps,l=e.className,d=Object(r.useRef)(null);return Object(r.useEffect)((function(){var e=d.current,t=e.getContext("2d");0!==a&&0!==i||console.error("Fail to create the drawing"),e.width=a,e.height=i,t?function(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];e.clearRect(0,0,t,n),e.fillStyle="#000000",e.fillRect(0,0,t,n),e.scale(a,i),o.forEach((function(t){b(e,t)}))}(t,a,i,o,c,s):console.error("ctx is null the drawing can not be done")}),[a,i,o,c,s]),Object(h.jsx)("div",{children:Object(h.jsxs)(u.b,{children:[Object(h.jsx)("canvas",{className:l,id:t,ref:d}),Object(h.jsx)(x.a,{fontSize:"sm",children:n})]})})}function v(e){var t=e.name,n=e.label,a=e.width,i=e.height,o=e.ratioW,c=e.ratioH,s=e.data,l=e.className,b=Object(r.useRef)(null);return Object(r.useEffect)((function(){var e=b.current,t=e.getContext("2d");0!==a&&0!==i||console.error("Fail to create the drawing"),e.width=a,e.height=i,t?function(e,t,n,a,i,o,r){e.clearRect(0,0,t,n),e.putImageData(o,0,0),e.scale(a,i),e.drawImage(r,0,0)}(t,a,i,o,c,s,e):console.error("ctx is null the drawing can not be done")}),[a,i,o,c,s]),Object(h.jsx)("div",{children:Object(h.jsxs)(u.b,{children:[Object(h.jsx)("canvas",{className:l,id:t,ref:b}),Object(h.jsx)(x.a,{fontSize:"sm",children:n})]})})}var y=n(119);function S(e){var t=e.generation,n=e.fitness,a=e.ssim,i=e.pixelDiff,o=e.subPixel,r=e.polygon,c=e.idBest,s=e.elapsedTimeForGeneration,l=e.notImprovingSince,b=e.nbPolygons,d=e.className;return Object(h.jsx)("div",{className:d,children:Object(h.jsxs)(y.a,{variant:"striped",children:[Object(h.jsx)(y.e,{children:Object(h.jsx)(y.f,{children:Object(h.jsx)(y.d,{children:" Simulation "})})}),Object(h.jsxs)(y.b,{children:[Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Generation:"}),Object(h.jsx)(y.c,{isNumeric:!0,children:t})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Not improving since:"}),Object(h.jsx)(y.c,{isNumeric:!0,children:l})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Time by generation:"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[s," seconds"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Global fitness:"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[(100*n).toFixed(2),"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Ssim fitness:"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[(100*a).toFixed(2),"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Pixelmatch fitness:"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[(100*i).toFixed(2),"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Sub Pixel fitness:"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[(100*o).toFixed(2),"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Polygon fitness:"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[(100*r).toFixed(2),"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Best indivudial:"}),Object(h.jsx)(y.c,{isNumeric:!0,children:c})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Number of polygons:"}),Object(h.jsx)(y.c,{isNumeric:!0,children:b})]})]})]})})}n(95),n(96);var P=n(121);function R(e){var t=e.defaultVal,n=e.min,a=e.max,i=e.step,c=e.label,s=e.id,l=e.name,b=e.tooltip,d=e.onChange,j=Object(r.useState)(t),u=Object(o.a)(j,2),g=u[0],f=u[1];return Object(h.jsx)(P.a,{label:b,placement:"top",closeOnClick:!1,bg:"blue.50",color:"black",offset:[0,-20],children:Object(h.jsxs)("div",{className:"inputrange-wrapper",children:[Object(h.jsx)("label",{className:"inputrange-one",children:c}),Object(h.jsx)("input",{className:"inputrange-two",type:"range",id:s,name:l,min:n,max:a,step:i,value:g,onChange:function(e){var t=e.target.valueAsNumber;f(t),d(t)}}),Object(h.jsx)("span",{className:"inputrange-three",children:g})]})})}var C=n(120),N=n(128);function w(e){var t=e.population,n=e.parentSelectionStrategy,a=e.selectCutoff,i=e.tournamentSize,c=e.keepPreviousRatio,l=e.newIndividualRatio,b=e.crossoverParentRatio,d=e.mutationRate,j=e.crossoverStrategy,g=e.vertexMovement,f=e.colorModificationRate,m=e.copyColorNeighborRate,x=e.addPolygonRate,O=e.removePolygonRate,p=e.enableSsim,v=e.enablePixelDiff,y=e.enableSubDiff,S=e.ratioSsim,w=e.ratioPixelDiff,k=e.ratioSubDiff,V=e.ratioPolygons,D=e.enableTransparency,M=e.nbVertex,I=e.enableVariablePolygons,W=e.nbPolygons,T=e.resolution,F=e.onValuesChange,z=e.className,_=Object(r.useState)({population:t,parentSelectionStrategy:n,selectCutoff:a,tournamentSize:i,keepPreviousRatio:c,newIndividualRatio:l,crossoverParentRatio:b,mutationRate:d,crossoverStrategy:j,vertexMovement:g,colorModificationRate:f,copyColorNeighborRate:m,addPolygonRate:x,removePolygonRate:O,enableSsim:p,enablePixelDiff:v,enableSubDiff:y,ratioSsim:S,ratioPixelDiff:w,ratioSubDiff:k,ratioPolygons:V,enableTransparency:D,nbVertex:M,enableVariablePolygons:I,nbPolygons:W,resolution:T}),E=Object(o.a)(_,2),H=E[0],G=E[1];return Object(r.useEffect)((function(){F(H)}),[H,F]),Object(h.jsx)("div",{className:z,children:Object(h.jsxs)(u.b,{spacing:6,children:[Object(h.jsxs)("div",{children:[Object(h.jsx)(C.a,{as:"h4",size:"sm",children:"General"}),Object(h.jsx)(R,{id:"ga-population",name:"ga-population",label:"Population",tooltip:"Number of individuals (solutions) evaluated at each generation",min:10,max:300,defaultVal:H.population,step:1,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{population:e}))}}),Object(h.jsx)(R,{id:"ga-keep-previous",name:"ga-keep-previous",label:"Keep previous individual",tooltip:"Rate when building next generation to incorpore an individual from the previous generation",min:0,max:1,defaultVal:H.keepPreviousRatio,step:.01,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{keepPreviousRatio:e}))}}),Object(h.jsx)(R,{id:"ga-new-individual",name:"ga-new-individual",label:"Generate new individual",tooltip:"Rate when building next generation to incorpore a completely new random individual",min:0,max:1,defaultVal:H.newIndividualRatio,step:.01,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{newIndividualRatio:e}))}})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)(C.a,{as:"h4",size:"sm",children:"Crossover"}),Object(h.jsx)(P.a,{label:"The selection strategy to pick parents for generating the children of the next generation",placement:"top",closeOnClick:!1,bg:"blue.50",color:"black",offset:[0,-10],children:Object(h.jsxs)("div",{className:"gaconfiguration-wrapper",children:[Object(h.jsx)("label",{className:"gaconfiguration-one",children:"Type: "})," ",Object(h.jsx)("br",{}),Object(h.jsxs)("div",{className:"gaconfiguration-two",children:[Object(h.jsxs)("label",{className:"ga-strategy-label",htmlFor:"strategy-tournament",children:["Tournament ",Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"radio",id:"strategy-tournament",name:"parentstrategy",value:"tournament",checked:"tournament"===H.parentSelectionStrategy,onChange:function(e){G(Object(s.a)(Object(s.a)({},H),{},{parentSelectionStrategy:e.target.value}))}})]}),Object(h.jsxs)("label",{className:"ga-strategy-label",htmlFor:"strategy-fortunewheel",children:["Fortune Wheel ",Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"radio",id:"strategy-fortunewheel",name:"parentstrategy",value:"fortunewheel",checked:"fortunewheel"===H.parentSelectionStrategy,onChange:function(e){G(Object(s.a)(Object(s.a)({},H),{},{parentSelectionStrategy:e.target.value}))}})]})]})]})}),"tournament"===H.parentSelectionStrategy&&Object(h.jsx)(R,{id:"ga-selection-cutoff",name:"ga-selection-cutoff",label:"Selection cutoff",tooltip:"Quantity of the population to be considered for creating the tournament pool",min:0,max:1,defaultVal:H.selectCutoff,step:.05,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{selectCutoff:e}))}}),"tournament"===H.parentSelectionStrategy&&Object(h.jsx)(R,{id:"ga-tournament-size",name:"ga-tournament-size",label:"Tournament size",tooltip:"Number of participants from the pool to participate in each tournament",min:1,max:Math.round(H.selectCutoff*H.population),defaultVal:H.tournamentSize,step:1,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{tournamentSize:e}))}}),Object(h.jsx)(R,{id:"ga-crossover-parent",name:"ga-crossover-parent",label:"Main parent ratio",tooltip:"Quantity of genes to keep from the parent with the highest fitness",min:0,max:1,defaultVal:H.crossoverParentRatio,step:.05,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{crossoverParentRatio:e}))}}),Object(h.jsx)(P.a,{label:"The granularity used for the crossover of the two parents",placement:"top",closeOnClick:!1,bg:"blue.50",color:"black",offset:[0,-20],children:Object(h.jsxs)("div",{className:"gaconfiguration-wrapper",children:[Object(h.jsx)("label",{className:"gaconfiguration-one",children:"Granularity: "})," ",Object(h.jsx)("br",{}),Object(h.jsxs)("div",{className:"gaconfiguration-two",children:[Object(h.jsxs)("label",{className:"ga-strategy-label",htmlFor:"strategy-polygon",children:["Polygons ",Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"radio",id:"strategy-polygon",name:"strategy",value:"polygon",checked:"polygon"===H.crossoverStrategy,onChange:function(e){G(Object(s.a)(Object(s.a)({},H),{},{crossoverStrategy:e.target.value}))}})]}),Object(h.jsxs)("label",{className:"ga-strategy-label",htmlFor:"strategy-vertex",children:["Vertex ",Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"radio",id:"strategy-vertex",name:"strategy",value:"vertex",checked:"vertex"===H.crossoverStrategy,onChange:function(e){G(Object(s.a)(Object(s.a)({},H),{},{crossoverStrategy:e.target.value}))}})]}),Object(h.jsxs)("label",{className:"ga-strategy-label",htmlFor:"strategy-data",children:["Data ",Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"radio",id:"strategy-data",name:"strategy",value:"data",checked:"data"===H.crossoverStrategy,onChange:function(e){G(Object(s.a)(Object(s.a)({},H),{},{crossoverStrategy:e.target.value}))}})]}),Object(h.jsxs)("label",{className:"ga-strategy-label",htmlFor:"strategy-singlePoint",children:["Single point ",Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"radio",id:"strategy-singlePoint",name:"strategy",value:"singlePoint",checked:"singlePoint"===H.crossoverStrategy,onChange:function(e){G(Object(s.a)(Object(s.a)({},H),{},{crossoverStrategy:e.target.value}))}})]})]})]})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)(C.a,{as:"h4",size:"sm",children:"Mutation"}),Object(h.jsx)(R,{id:"ga-mutation",name:"ga-mutation",label:"Mutation rate",tooltip:"Rate of mutation applied to each gene of an individual",min:0,max:1,defaultVal:H.mutationRate,step:.01,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{mutationRate:e}))}}),Object(h.jsx)(R,{id:"ga-vertex-movement",name:"ga-vertex-movement",label:"Vertex movement",tooltip:"Maximum pourcentage of the image resolution to use as range for moving a vertex during mutation",min:0,max:.5,defaultVal:H.vertexMovement,step:.01,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{vertexMovement:e}))}}),Object(h.jsx)(R,{id:"ga-color-modification",name:"ga-color-modification",label:"Color modification",tooltip:"Maximum pourcentage for changing a color component during mutation",min:0,max:1,defaultVal:H.colorModificationRate,step:.01,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{colorModificationRate:e}))}}),Object(h.jsx)(R,{id:"ga-color-copy",name:"ga-color-copy",label:"Copy neighbor color",min:0,max:1,tooltip:"Rate when mutating color to get the color from the closest neighbor than changing the value by a percentage",defaultVal:H.copyColorNeighborRate,step:.01,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{copyColorNeighborRate:e}))}}),Object(h.jsx)(R,{id:"ga-add-polygon",name:"ga-add-polygon",label:"Add polygon",min:0,max:1,tooltip:"Rate when mutating polygon to insert an additional polygon (variable number of polygons should be enabled) ",defaultVal:H.addPolygonRate,step:.01,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{addPolygonRate:e}))}}),Object(h.jsx)(R,{id:"ga-remove-polygon",name:"ga-remove-polygon",label:"Remove polygon",min:0,max:1,tooltip:"Rate when mutation polygon to remove the current polygon (variable number of polygons should be enabled)",defaultVal:H.removePolygonRate,step:.01,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{removePolygonRate:e}))}})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)(C.a,{as:"h4",size:"sm",children:"Image rendering"}),Object(h.jsx)(R,{id:"ga-resolution",name:"ga-resolution",label:"resolution",tooltip:"Resolution used for the original image during simulation (less for faster computing but less rendering quality)",min:32,max:256,defaultVal:H.resolution,step:32,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{resolution:e}))}}),Object(h.jsx)(P.a,{label:"Enable the Ssim fitness function (help to build the image's structure)",placement:"top",closeOnClick:!1,bg:"blue.50",color:"black",offset:[0,-20],children:Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"ga-ssim",children:"SSIM:"}),Object(h.jsx)(N.a,{className:"ga-chakra-switch",id:"ga-ssim",value:"ssim",isChecked:H.enableSsim,onChange:function(e){G(Object(s.a)(Object(s.a)({},H),{},{enableSsim:e.target.checked}))}})]})}),Object(h.jsx)(P.a,{label:"Enable the Pixelmatch fitness function (help to fit the colors, consider as well other image's attributes)",placement:"top",closeOnClick:!1,bg:"blue.50",color:"black",offset:[0,-20],children:Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"ga-pixeldiff",children:"Pixel differenciation:"}),Object(h.jsx)(N.a,{className:"ga-chakra-switch",id:"ga-pixeldiff",value:"pixeldiff",isChecked:H.enablePixelDiff,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{enablePixelDiff:e.target.checked}))}})]})}),Object(h.jsx)(P.a,{label:"Enable the average difference between pixels fitness function (help to fit the colors)",placement:"top",closeOnClick:!1,bg:"blue.50",color:"black",offset:[0,-20],children:Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"ga-subdiff",children:"Pixel substraction:"}),Object(h.jsx)(N.a,{className:"ga-chakra-switch",id:"ga-subdiff",value:"subdiff",isChecked:H.enableSubDiff,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{enableSubDiff:e.target.checked}))}})]})}),Object(h.jsx)(P.a,{label:"Enable the action to add / remove a polygon from an individual",placement:"top",closeOnClick:!1,bg:"blue.50",color:"black",offset:[0,-20],children:Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"ga-enableVariablePolygons",children:"Variable number of polygons:"}),Object(h.jsx)(N.a,{className:"ga-chakra-switch",id:"ga-enableVariablePolygons",value:"enableVariablePolygons",isChecked:H.enableVariablePolygons,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{enableVariablePolygons:e.target.checked}))}})]})}),H.enableSsim&&Object(h.jsx)(R,{id:"ga-ssim-ratio",name:"ga-ssim-ratio",label:"Ratio Ssim",tooltip:"Weight for computing the global fitness",min:0,max:10,defaultVal:H.ratioSsim,step:.1,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{ratioSsim:e}))}}),H.enablePixelDiff&&Object(h.jsx)(R,{id:"ga-pixldiff-ratio",name:"ga-pixldiff-ration",label:"Ratio Pixelmatch",tooltip:"Weight for computing the global fitness",min:0,max:10,defaultVal:H.ratioPixelDiff,step:.1,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{ratioPixelDiff:e}))}}),H.enableSubDiff&&Object(h.jsx)(R,{id:"ga-subdiff-ratio",name:"ga-subdiff-ration",label:"Ratio Sub diff",tooltip:"Weight for computing the global fitness",min:0,max:10,defaultVal:H.ratioSubDiff,step:.1,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{ratioSubDiff:e}))}}),H.enableVariablePolygons&&Object(h.jsx)(R,{id:"ga-polygons-ratio",name:"ga-polygons-ration",label:"Ratio polygons",tooltip:"Weight for computing the global fitness",min:0,max:10,defaultVal:H.ratioPolygons,step:.1,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{ratioPolygons:e}))}}),Object(h.jsx)(P.a,{label:"Enable the transparency when drawing the polygons",placement:"top",closeOnClick:!1,bg:"blue.50",color:"black",offset:[0,-20],children:Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"ga-transparency",children:"Transparency:"}),Object(h.jsx)(N.a,{className:"ga-chakra-switch",id:"ga-transparency",value:"transparency",isChecked:H.enableTransparency,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{enableTransparency:e.target.checked}))}})]})}),Object(h.jsx)(R,{id:"ga-vertex",name:"ga-vertex",label:"Vertex",tooltip:"Number of vertex for the polygons used for the drawing (3 is a triangle)",min:3,max:10,defaultVal:H.nbVertex,step:1,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{nbVertex:e}))}}),Object(h.jsx)(R,{id:"ga-vertices",name:"ga-vertices",label:"Vertices",tooltip:"Number of polygons used for the drawing (this number is fixed during the evolution)",min:1,max:500,defaultVal:H.nbPolygons,step:1,onChange:function(e){return G(Object(s.a)(Object(s.a)({},H),{},{nbPolygons:e}))}})]})]})})}function k(e){var t=e.population,n=e.parentSelectionStrategy,a=e.selectCutoff,i=e.tournamentSize,o=e.keepPreviousRatio,r=e.newIndividualRatio,c=e.crossoverParentRatio,s=e.mutationRate,l=e.crossoverStrategy,b=e.vertexMovement,d=e.colorModificationRate,j=e.copyColorNeighborRate,g=e.addPolygonRate,f=e.removePolygonRate,m=e.enableSsim,x=e.enablePixelDiff,O=e.enableSubDiff,p=e.ratioSsim,v=e.ratioPixelDiff,S=e.ratioSubDiff,P=e.ratioPolygons,R=e.enableTransparency,C=e.nbVertex,N=e.enableVariablePolygons,w=e.nbPolygons,k=e.resolution,V=e.className;return Object(h.jsx)("div",{className:V,children:Object(h.jsxs)(u.b,{spacing:6,children:[Object(h.jsxs)(y.a,{variant:"striped",children:[Object(h.jsx)(y.e,{children:Object(h.jsx)(y.f,{children:Object(h.jsx)(y.d,{children:"General"})})}),Object(h.jsxs)(y.b,{children:[Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Population size: "}),Object(h.jsx)(y.c,{isNumeric:!0,children:t})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Keep from previous generation: "}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[100*o,"% "]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Insert new individual in generation: "}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[100*r,"% "]})]})]})]}),Object(h.jsxs)(y.a,{variant:"striped",children:[Object(h.jsx)(y.e,{children:Object(h.jsx)(y.f,{children:Object(h.jsx)(y.d,{children:"Crossover"})})}),Object(h.jsxs)(y.b,{children:[Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Parent selection strategy:"}),Object(h.jsx)(y.c,{isNumeric:!0,children:n})]}),function(){var e=[];return e.push(Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:" Selection cutoff:"}),Object(h.jsx)(y.c,{isNumeric:!0,children:a})]},"tr-1")),e.push(Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:" Tournament size::"}),Object(h.jsx)(y.c,{isNumeric:!0,children:i})]},"tr-2")),e}(),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Main parent ratio during crossover :"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[100*c,"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Crossover strategy :"}),Object(h.jsx)(y.c,{isNumeric:!0,children:l})]})]})]}),Object(h.jsxs)(y.a,{variant:"striped",children:[Object(h.jsx)(y.e,{children:Object(h.jsx)(y.f,{children:Object(h.jsx)(y.d,{children:"Mutation"})})}),Object(h.jsxs)(y.b,{children:[Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Mutation rate :"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[100*s,"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Copy neighbor color rate :"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[100*j,"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Vertex movement during mutation :"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[100*b,"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Color movement during mutation :"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[100*d,"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Add polygon during mutation :"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[100*g,"%"]})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Remove polygon during mutation :"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[100*f,"%"]})]})]})]}),Object(h.jsxs)(y.a,{variant:"striped",children:[Object(h.jsx)(y.e,{children:Object(h.jsx)(y.f,{children:Object(h.jsx)(y.d,{children:"Image rendering"})})}),Object(h.jsxs)(y.b,{children:[Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Resolution :"}),Object(h.jsxs)(y.c,{isNumeric:!0,children:[k,"px"]})]}),function(){var e=[];m&&e.push("Ssim ("+p+")"),x&&e.push("Pixel diff ("+v+")"),O&&e.push("Sub diff ("+S+")"),N&&e.push("Polygons ("+P+")");var t=[];return t.push(Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:" Fitness functions:"}),Object(h.jsx)(y.c,{isNumeric:!0,children:e.join(", ")})]},"tr-3")),t}(),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Transparency enabled :"}),Object(h.jsx)(y.c,{isNumeric:!0,children:R})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Variable number of polygons:"}),Object(h.jsx)(y.c,{isNumeric:!0,children:N})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Vertex by polygon :"}),Object(h.jsx)(y.c,{isNumeric:!0,children:C})]}),Object(h.jsxs)(y.f,{children:[Object(h.jsx)(y.c,{children:"Generated polygons :"}),Object(h.jsx)(y.c,{isNumeric:!0,children:w})]})]})]})]})})}var V=n(122);var D=function(){var e=Object(r.useState)({population:50,parentSelectionStrategy:"tournament",selectCutoff:.2,tournamentSize:3,keepPreviousRatio:.01,newIndividualRatio:.01,crossoverParentRatio:.6,mutationRate:.01,crossoverStrategy:"polygon",vertexMovement:.15,colorModificationRate:.1,copyColorNeighborRate:.01,addPolygonRate:.1,removePolygonRate:.1,enableSsim:!0,enablePixelDiff:!1,enableSubDiff:!1,enableVariablePolygons:!0,ratioSsim:1,ratioPixelDiff:1,ratioSubDiff:1,ratioPolygons:.05,enableTransparency:!0,nbVertex:3,nbPolygons:26,resolution:64}),t=Object(o.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)({isRunning:!1,best:{genes:[],fitness:0,ssim:0,pixelDiff:0,subPixel:0,polygon:0,diff:void 0,id:0,probability:0,phenotype:[]},population:[],generation:0,elapsedTime:0,notImprovingSince:0}),s=Object(o.a)(i,2),l=s[0],b=s[1],j=Object(r.useState)(void 0),u=Object(o.a)(j,2),g=u[0],m=u[1],x=Object(r.useState)(""),y=Object(o.a)(x,2),P=y[0],R=y[1],C=Object(r.useState)({image:null,renderedWidth:0,renderedHeight:0,ratioOffscreenWidth:0,ratioOffscreenHeight:0,offscreenWidth:0,offscreenHeight:0,limitOffscreen:0}),N=Object(o.a)(C,2),D=N[0],M=N[1],I=Object(r.useState)(null),W=Object(o.a)(I,2),T=W[0],F=W[1],z=Object(r.useState)(!0),_=Object(o.a)(z,2),E=_[0],H=_[1],G=Object(r.useCallback)((function(e){var t=e.data;m(t)}),[]),L=Object(r.useCallback)((function(e){var t=new c;F(t),H(!1),R(e)}),[]);Object(r.useEffect)((function(){T&&(console.log("Add listener to worker"),T.addEventListener("message",G))}),[T,G]),Object(r.useEffect)((function(){if(T&&D.image&&g&&!E){b(g);var e={isRunning:g.isRunning,image:D.image,configuration:n,notImprovingSince:g.notImprovingSince,best:g.best,population:g.population,generation:g.generation,renderingHeight:D.offscreenHeight,renderingWidth:D.offscreenWidth};T.postMessage(e)}}),[T,g,D,n,E]);var A=Object(r.useCallback)((function(){T&&(T.terminate(),b({isRunning:!1,best:{genes:[],fitness:0,ssim:0,pixelDiff:0,subPixel:0,polygon:0,diff:void 0,id:0,probability:0,phenotype:[]},population:[],generation:0,elapsedTime:0,notImprovingSince:0}),R(""),H(!0),m(void 0))}),[T]),J=Object(r.useCallback)((function(e,t,a){var i=d(e.width,e.height,n.resolution),o=i.width/t,r=i.height/a,c=new OffscreenCanvas(i.width,i.height).getContext("2d");if(c){c.scale(o,r),c.drawImage(e,0,0,t,a);var s=c.getImageData(0,0,i.width,i.height);if(M({image:s,renderedWidth:t,renderedHeight:a,offscreenWidth:i.width,offscreenHeight:i.height,ratioOffscreenWidth:o,ratioOffscreenHeight:r,limitOffscreen:n.resolution}),T&&s){var b={isRunning:l.isRunning,image:s,configuration:n,notImprovingSince:l.notImprovingSince,best:l.best,population:l.population,generation:l.generation,renderingHeight:i.height,renderingWidth:i.width};console.log("post message for first generation"),T.postMessage(b)}}else console.error("ctx from url image for resizing could not be created")}),[l,T,n]),Q=Object(r.useCallback)((function(){H(!0)}),[]),B=Object(r.useCallback)((function(e){a(e)}),[]);return Object(h.jsxs)("div",{className:"wrapper",children:[Object(h.jsx)(f,{className:"one",links:[{name:"Joconde",link:"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/390px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg"},{name:"Einstein",link:"https://raw.githubusercontent.com/obartra/ssim/master/spec/samples/einstein/Q1.gif"},{name:"Photographer",link:"https://i.picsum.photos/id/823/420/560.jpg?hmac=H6lJE4fRi96MxgWYyd3_79WbmObu-jJj7Zo40p5I-nU"},{name:"Landscape",link:"https://i.picsum.photos/id/1015/420/560.jpg?hmac=JcSYiOeUMQYq_XstyekCWyhAlg_e8UiPWxp66v-ki6Q"},{name:"Random",link:"https://picsum.photos/420/560"}],start:L,stop:A,isStopped:E}),P&&Object(h.jsx)(O,{className:"two",classNameOnError:"twoExpanded",name:"original-image",label:"Original",onImageDrawn:J,onLoadingError:Q,limit:256,url:P}),D.image&&!E&&Object(h.jsx)(v,{className:"three",name:"simu-image",label:"In memory",width:D.renderedWidth,height:D.renderedHeight,ratioW:1/D.ratioOffscreenWidth,ratioH:1/D.ratioOffscreenHeight,data:D.image}),D.image&&!E&&Object(h.jsx)(p,{className:"four",name:"generated-image",label:"Maestro painting",width:D.renderedWidth,height:D.renderedHeight,ratioW:1/D.ratioOffscreenWidth,ratioH:1/D.ratioOffscreenHeight,drawingSteps:l.best.phenotype}),l.best.diff&&!E&&Object(h.jsx)(v,{className:"five",name:"diff-image",label:"Memory VS Painting",width:D.renderedWidth,height:D.renderedHeight,ratioW:1/D.ratioOffscreenWidth,ratioH:1/D.ratioOffscreenHeight,data:l.best.diff}),!E&&Object(h.jsx)("div",{className:"six",children:Object(h.jsxs)(V.e,{children:[Object(h.jsxs)(V.b,{children:[Object(h.jsx)(V.a,{children:"Painting Art"}),Object(h.jsx)(V.a,{children:"Genetic Algorithm parameters"})]}),Object(h.jsxs)(V.d,{children:[Object(h.jsx)(V.c,{children:Object(h.jsx)(S,{className:"",generation:l.generation,fitness:l.best.fitness,ssim:l.best.ssim,pixelDiff:l.best.pixelDiff,subPixel:l.best.subPixel,polygon:l.best.polygon,idBest:l.best.id,elapsedTimeForGeneration:l.elapsedTime,notImprovingSince:l.notImprovingSince,nbPolygons:l.best.genes.length/10})}),Object(h.jsx)(V.c,{children:Object(h.jsx)(k,{population:n.population,parentSelectionStrategy:n.parentSelectionStrategy,selectCutoff:n.selectCutoff,tournamentSize:n.tournamentSize,keepPreviousRatio:n.keepPreviousRatio,newIndividualRatio:n.newIndividualRatio,crossoverParentRatio:n.crossoverParentRatio,mutationRate:n.mutationRate,crossoverStrategy:n.crossoverStrategy,vertexMovement:n.vertexMovement,colorModificationRate:n.colorModificationRate,copyColorNeighborRate:n.copyColorNeighborRate,addPolygonRate:n.addPolygonRate,removePolygonRate:n.removePolygonRate,enableSsim:n.enableSsim,enablePixelDiff:n.enablePixelDiff,enableSubDiff:n.enableSubDiff,ratioSsim:n.ratioSsim,ratioPixelDiff:n.ratioPixelDiff,ratioSubDiff:n.ratioSubDiff,ratioPolygons:n.ratioPolygons,enableTransparency:n.enableTransparency,nbVertex:n.nbVertex,enableVariablePolygons:n.enableVariablePolygons,nbPolygons:n.nbPolygons,resolution:n.resolution,className:""})})]})]})}),E&&Object(h.jsx)(w,{population:n.population,parentSelectionStrategy:n.parentSelectionStrategy,selectCutoff:n.selectCutoff,tournamentSize:n.tournamentSize,keepPreviousRatio:n.keepPreviousRatio,newIndividualRatio:n.newIndividualRatio,crossoverParentRatio:n.crossoverParentRatio,mutationRate:n.mutationRate,crossoverStrategy:n.crossoverStrategy,vertexMovement:n.vertexMovement,colorModificationRate:n.colorModificationRate,copyColorNeighborRate:n.copyColorNeighborRate,addPolygonRate:n.addPolygonRate,removePolygonRate:n.removePolygonRate,enableSsim:n.enableSsim,enablePixelDiff:n.enablePixelDiff,enableSubDiff:n.enableSubDiff,enableVariablePolygons:n.enableVariablePolygons,ratioSsim:n.ratioSsim,ratioPixelDiff:n.ratioPixelDiff,ratioSubDiff:n.ratioSubDiff,ratioPolygons:n.ratioPolygons,enableTransparency:n.enableTransparency,nbVertex:n.nbVertex,nbPolygons:n.nbPolygons,resolution:n.resolution,className:"six",onValuesChange:B})]})},M=document.getElementById("root");Object(i.render)(Object(h.jsx)(a.a,{children:Object(h.jsx)(D,{})}),M)}},[[97,1,2]]]);
//# sourceMappingURL=main.2a3b75e9.chunk.js.map